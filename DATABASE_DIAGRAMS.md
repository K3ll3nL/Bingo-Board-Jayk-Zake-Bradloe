# Pokemon Bingo - Database Relationships Diagram

## Entity Relationship Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  pokemon_master     â”‚  â† Master Pokemon data (1000+ rows)
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â€¢ national_dex_id  â”‚
â”‚  â€¢ name             â”‚
â”‚  â€¢ gif_url          â”‚
â”‚  â€¢ sprite_url       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Referenced by
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  monthly_pokemon_pool   â”‚ â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  bingo_months   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚         â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â€¢ id                   â”‚         â”‚  â€¢ id           â”‚
â”‚  â€¢ month_id        â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  â€¢ month_year   â”‚
â”‚  â€¢ national_dex_id      â”‚         â”‚  â€¢ start_date   â”‚
â”‚  â€¢ position             â”‚         â”‚  â€¢ end_date     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â€¢ is_active    â”‚
           â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ 24 Pokemon per month           â”‚
           â”‚                                 â”‚
           â–¼                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  user_bingo_boards  â­    â”‚              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚              â”‚
â”‚  â€¢ id                       â”‚              â”‚
â”‚  â€¢ user_id         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â€¢ month_id        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”˜
â”‚  â€¢ position (1-25)          â”‚      â”‚
â”‚  â€¢ national_dex_id          â”‚      â”‚
â”‚  â€¢ is_checked               â”‚      â”‚
â”‚  â€¢ checked_at               â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
              â”‚                       â”‚
              â”‚ Triggers              â”‚
              â”‚                       â”‚
              â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  user_monthly_points  â­ â”‚   â”‚     users     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â€¢ id                    â”‚   â”‚  â€¢ id (UUID)  â”‚
â”‚  â€¢ user_id       â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â–ºâ”‚  â€¢ username   â”‚
â”‚  â€¢ month_id              â”‚   â”‚  â€¢ display_n. â”‚
â”‚  â€¢ points                â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â€¢ bingos_completed      â”‚
â”‚  â€¢ last_updated          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–²
              â”‚
              â”‚ Records achievements
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  bingo_achievements      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â€¢ id                    â”‚
â”‚  â€¢ user_id               â”‚
â”‚  â€¢ month_id              â”‚
â”‚  â€¢ bingo_type            â”‚
â”‚  â€¢ bingo_index           â”‚
â”‚  â€¢ achieved_at           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Diagram

```
ADMIN SETUP (Monthly)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 1. Create new month â”‚
   â”‚ in bingo_months     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 2. Select 24 Pokemon    â”‚
   â”‚ from pokemon_master     â”‚
   â”‚ â†’ monthly_pokemon_pool  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 3. For each user:               â”‚
   â”‚ generate_user_board()           â”‚
   â”‚ â†’ Creates 25 rows in            â”‚
   â”‚   user_bingo_boards (random)    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


USER GAMEPLAY
â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ User clicks square  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ UPDATE user_bingo_boards     â”‚
   â”‚ SET is_checked = true        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ Trigger fires
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ check_and_update_bingos()      â”‚
   â”‚ â€¢ Checks all rows/cols/diags   â”‚
   â”‚ â€¢ Counts completed bingos      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”œâ”€â–º Records to bingo_achievements
              â”‚
              â””â”€â–º Updates user_monthly_points
                  (points = bingos Ã— 100)


LEADERBOARD QUERY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ SELECT from user_monthly_pointsâ”‚
   â”‚ JOIN users                     â”‚
   â”‚ WHERE month = current          â”‚
   â”‚ ORDER BY points DESC           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ FAST! (precomputed points)     â”‚
   â”‚ No calculation needed          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Monthly Lifecycle

```
JANUARY 2026
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€ pokemon_master â”€â”€â”€â”€â”
â”‚  All 1000+ Pokemon    â”‚  â† Permanent reference data
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€ bingo_months â”€â”€â”€â”€â”€â”€â”
â”‚  id: 1                â”‚
â”‚  month_year: 2026-01  â”‚
â”‚  is_active: TRUE      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€ monthly_pokemon_pool â”€â”€â”€â”€â”€â”
â”‚  month_id: 1                  â”‚
â”‚  24 Pokemon selected:         â”‚
â”‚  â€¢ Pikachu (#25)              â”‚
â”‚  â€¢ Charizard (#6)             â”‚
â”‚  â€¢ Mewtwo (#150)              â”‚
â”‚  â€¢ ... 21 more                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€ user_bingo_boards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER: Ash (2026-01)          â”‚
â”‚  â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”       â”‚
â”‚  â”‚ 4 â”‚150â”‚ 1 â”‚ 25â”‚ 6 â”‚  R1   â”‚
â”‚  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤       â”‚
â”‚  â”‚130â”‚ 94â”‚ 54â”‚133â”‚131â”‚  R2   â”‚
â”‚  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤       â”‚
â”‚  â”‚ 39â”‚ 52â”‚ ğŸ†“â”‚144â”‚145â”‚  R3   â”‚  â† Position 13 = FREE
â”‚  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤       â”‚
â”‚  â”‚146â”‚149â”‚ 50â”‚132â”‚137â”‚  R4   â”‚
â”‚  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤       â”‚
â”‚  â”‚ 59â”‚ 68â”‚143â”‚ 7 â”‚151â”‚  R5   â”‚
â”‚  â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜       â”‚
â”‚   C1  C2  C3  C4  C5          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€ user_bingo_boards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER: Misty (2026-01)        â”‚
â”‚  â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”       â”‚  â† Different random
â”‚  â”‚ 25â”‚ 6 â”‚131â”‚ 4 â”‚145â”‚  R1   â”‚     arrangement!
â”‚  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤       â”‚     Same 24 Pokemon,
â”‚  â”‚149â”‚ 52â”‚ 94â”‚ 54â”‚ 1 â”‚  R2   â”‚     different order
â”‚  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤       â”‚
â”‚  â”‚150â”‚ 39â”‚ ğŸ†“â”‚133â”‚130â”‚  R3   â”‚
â”‚  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤       â”‚
â”‚  â”‚144â”‚ 68â”‚ 7 â”‚146â”‚ 59â”‚  R4   â”‚
â”‚  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤       â”‚
â”‚  â”‚137â”‚ 50â”‚143â”‚151â”‚132â”‚  R5   â”‚
â”‚  â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


FEBRUARY 2026
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€ bingo_months â”€â”€â”€â”€â”€â”€â”
â”‚  id: 2                â”‚  â† New month created
â”‚  month_year: 2026-02  â”‚
â”‚  is_active: TRUE      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€ bingo_months â”€â”€â”€â”€â”€â”€â”
â”‚  id: 1                â”‚  â† January deactivated
â”‚  month_year: 2026-01  â”‚
â”‚  is_active: FALSE     â”‚  â† Data preserved!
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€ monthly_pokemon_pool â”€â”€â”€â”€â”€â”
â”‚  month_id: 2                  â”‚  â† Different 24 Pokemon!
â”‚  24 NEW Pokemon:              â”‚
â”‚  â€¢ Gengar (#94)               â”‚
â”‚  â€¢ Dragonite (#149)           â”‚
â”‚  â€¢ Mew (#151)                 â”‚
â”‚  â€¢ ... 21 more                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

New boards generated for all users with February's Pokemon...
```

## Bingo Detection Logic

```
POSITION GRID (1-25)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    C1  C2  C3  C4  C5
   â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
R1 â”‚ 1 â”‚ 2 â”‚ 3 â”‚ 4 â”‚ 5 â”‚
   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
R2 â”‚ 6 â”‚ 7 â”‚ 8 â”‚ 9 â”‚10 â”‚
   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
R3 â”‚11 â”‚12 â”‚13 â”‚14 â”‚15 â”‚  â† 13 = FREE SPACE
   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
R4 â”‚16 â”‚17 â”‚18 â”‚19 â”‚20 â”‚
   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
R5 â”‚21 â”‚22 â”‚23 â”‚24 â”‚25 â”‚
   â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
    â†˜           â†™
     Diagonal Diagonal
        1         2


BINGO TYPES (12 possible)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Rows (5):
  R1: positions 1, 2, 3, 4, 5
  R2: positions 6, 7, 8, 9, 10
  R3: positions 11, 12, 13, 14, 15
  R4: positions 16, 17, 18, 19, 20
  R5: positions 21, 22, 23, 24, 25

Columns (5):
  C1: positions 1, 6, 11, 16, 21
  C2: positions 2, 7, 12, 17, 22
  C3: positions 3, 8, 13, 18, 23
  C4: positions 4, 9, 14, 19, 24
  C5: positions 5, 10, 15, 20, 25

Diagonals (2):
  D1: positions 1, 7, 13, 19, 25 (â†˜)
  D2: positions 5, 9, 13, 17, 21 (â†™)

Maximum Score: 12 bingos Ã— 100 points = 1200 points
```

## Key Insights

### âœ… Benefits of This Design

1. **Per-User Randomization**
   - Everyone gets different board layout
   - More engaging than shared board
   - Fair competition (same 24 Pokemon pool)

2. **Monthly Freshness**
   - New Pokemon selection each month
   - Historical data preserved
   - Easy to query past performance

3. **Fast Leaderboards**
   - Points precomputed in `user_monthly_points`
   - No expensive calculations on query
   - Can handle 10,000+ users easily

4. **Automatic Scoring**
   - Triggers handle bingo detection
   - Points updated immediately
   - No manual recalculation needed

5. **Scalability**
   - Add unlimited Pokemon
   - Support unlimited users
   - Archive old months without affecting performance

### ğŸ¯ Design Decisions Explained

**Q: Why separate `monthly_pokemon_pool` from `user_bingo_boards`?**
A: Admin selects 24 Pokemon ONCE per month. Each user gets a random arrangement of those 24. Separation = less duplication.

**Q: Why precompute points in `user_monthly_points`?**
A: Calculating bingos for 1000 users = slow. Precomputing = instant leaderboards.

**Q: Why use triggers instead of calculating on read?**
A: Write-time calculation (trigger) = fast reads. Read-time calculation = slow every page load.

**Q: Why store `bingo_achievements` separately?**
A: Could calculate from board state, but storing explicitly enables:
- Achievement notifications
- Historical timeline
- Analytics on which bingos are common
- Potential bonus points for first bingo

This design prioritizes **performance** and **user experience** while maintaining **data integrity**.
